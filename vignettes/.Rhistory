# Install canHealthWaitR from GitHub if not already installed
if (!requireNamespace("canHealthWaitR", quietly = TRUE)) {
devtools::install_github("Ella0921/canHealthWaitR")
}
# Load packages
library(canHealthWaitR)
library(dplyr)
library(ggplot2)
# Install canHealthWaitR from GitHub if not already installed
if (!requireNamespace("canHealthWaitR", quietly = TRUE)) {
devtools::install_github("Ella0921/canHealthWaitR")
}
# Load packages
library(canHealthWaitR)
library(dplyr)
library(ggplot2)
# Install canHealthWaitR from GitHub if not already installed
if (!requireNamespace("canHealthWaitR", quietly = TRUE)) {
devtools::install_github("Ella0921/canHealthWaitR")
}
# Load packages
library(canHealthWaitR)
library(dplyr)
library(ggplot2)
ls("package:canHealthWaitR")
mw_list_tables()
# Resolve a table from the registry using its table_key
tbl <- mw_resolve_table("wait_time")
tbl
pid <- tbl$product_id[[1]]
raw <- mw_read_data(pid)
std <- mw_standardize(raw, table_id = pid)
names(std)
dplyr::glimpse(std)
# Compare raw vs standardized structure
dplyr::glimpse(raw)
dplyr::glimpse(std)
#' @export
mw_plot_affected_province <- function(...) { ... }
mw_plot_affected_province(std, year = 2024)
mw_plot_affected_province(std, year = 2024)
mw_plot_affected_province(std, year = 2024)
mw_plot_satisfaction_stack(std, year = 2024)
mw_plot_affected_province(year = 2024)
getAnywhere(mw_plot_affected_province)
getAnywhere(canHealthWaitR::mw_plot_affected_province)
getAnywhere("mw_plot_affected_province")
getFromNamespace("mw_plot_affected_province", "canHealthWaitR")
mw_plot_affected_province(std, year = 2024)
mw_plot_affected_province(std, year = 2024)
mw_plot_affected_province(std, year = 2024)
# Install canHealthWaitR from GitHub if not already installed
if (!requireNamespace("canHealthWaitR", quietly = TRUE)) {
devtools::install_github("Ella0921/canHealthWaitR")
}
# Load packages
library(canHealthWaitR)
library(dplyr)
library(ggplot2)
# Install canHealthWaitR from GitHub if not already installed
if (!requireNamespace("canHealthWaitR", quietly = TRUE)) {
devtools::install_github("Ella0921/canHealthWaitR")
}
# Load packages
library(canHealthWaitR)
library(dplyr)
library(ggplot2)
mw_plot_affected_province(std, year = 2024)
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>",
message = FALSE,
warning = FALSE
)
# Make sure all chunks run from the package root directory
knitr::opts_knit$set(root.dir = normalizePath(".."))
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>",
message = FALSE,
warning = FALSE
)
library(canHealthWaitR)
library(dplyr)
library(ggplot2)
mw_list_tables()
ls("package:canHealthWaitR")
# Resolve a table from the registry using its table_key
tbl <- mw_resolve_table("wait_time")
tbl
pid <- tbl$product_id[[1]]
raw <- mw_read_data(pid)
std <- mw_standardize(raw, table_id = pid)
names(std)
dplyr::glimpse(std)
# Compare raw vs standardized structure
dplyr::glimpse(raw)
dplyr::glimpse(std)
#' @export
mw_plot_affected_province <- function(...) { ... }
mw_plot_affected_province(std, year = 2024)
mw_plot_satisfaction_stack(std, year = 2024)
mw_plot_wait_duration_stack(std, year = 2024)
mw_plot_affected_province(std, year = 2024)
mw_plot_affected_province(std, year = 2024)
tbl <- mw_resolve_table("wait_time")
tbl <- mw_resolve_table("wait_time")
range(std$ref_date, na.rm = TRUE)
unique(std$stat)
length(unique(std$indicator))
head(sort(unique(std$indicator)))
std_n <- dplyr::filter(std, stat == "Number of persons")
mw_plot_satisfaction_stack(std_n, year = 2024)
mw_plot_affected_province(std_n, year = 2024)
mw_plot_affected_province(std_n, year = 2024)
# Install canHealthWaitR from GitHub if not already installed
if (!requireNamespace("canHealthWaitR", quietly = TRUE)) {
devtools::install_github("Ella0921/canHealthWaitR")
}
# Load packages
library(canHealthWaitR)
library(dplyr)
library(ggplot2)
# Install canHealthWaitR from GitHub if not already installed
if (!requireNamespace("canHealthWaitR", quietly = TRUE)) {
devtools::install_github("Ella0921/canHealthWaitR")
}
# Load packages
library(canHealthWaitR)
library(dplyr)
library(ggplot2)
ls("package:canHealthWaitR")
df_aff <- std_n %>%
filter(ref_date == 2024,
indicator == "Life affected by wait time") %>%
filter(geo != "Canada (excluding territories)") %>%
arrange(value)
ggplot(df_aff, aes(x = reorder(geo, value), y = value)) +
geom_col() +
coord_flip() +
labs(
title = "People affected by healthcare wait times (2024)",
x = NULL,
y = "Number of persons"
) +
scale_y_continuous(labels = label_number(big.mark = ","))
df_aff <- std_n %>%
filter(ref_date == 2024,
indicator == "Life affected by wait time") %>%
filter(geo != "Canada (excluding territories)") %>%
arrange(value)
ggplot(df_aff, aes(x = reorder(geo, value), y = value)) +
geom_col() +
coord_flip() +
labs(
title = "People affected by healthcare wait times (2024)",
x = NULL,
y = "Number of persons"
) +
scale_y_continuous(labels = scales::label_number(big.mark = ","))
df_sat <- std_n %>%
filter(ref_date == 2024,
indicator %in% c(
"Satisfaction with wait time - Very satisfied or satisfied",
"Satisfaction with wait time - Dissatisfied or very dissatisfied"
)) %>%
filter(geo != "Canada (excluding territories)") %>%
group_by(geo) %>%
mutate(share = value / sum(value)) %>%
ungroup()
ggplot(df_sat, aes(x = geo, y = share, fill = indicator)) +
geom_col(position = "fill") +
coord_flip() +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
labs(
title = "Satisfaction with wait times by province (2024)",
x = NULL,
y = "Share of respondents",
fill = NULL
)
df_wait <- std_n %>%
filter(ref_date == 2024,
grepl("^Wait time,", indicator)) %>%
filter(geo != "Canada (excluding territories)") %>%
group_by(geo) %>%
mutate(share = value / sum(value)) %>%
ungroup()
ggplot(df_wait, aes(x = geo, y = share, fill = indicator)) +
geom_col(position = "fill") +
coord_flip() +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
labs(
title = "Distribution of specialist wait times by province (2024)",
x = NULL,
y = "Share of respondents",
fill = "Wait duration"
)
df_sat <- std_n %>%
filter(ref_date == 2024,
indicator %in% c(
"Satisfaction with wait time - Very satisfied or satisfied",
"Satisfaction with wait time - Dissatisfied or very dissatisfied"
)) %>%
filter(geo != "Canada (excluding territories)") %>%
group_by(geo) %>%
mutate(share = value / sum(value)) %>%
ungroup()
ggplot(df_sat, aes(x = geo, y = share, fill = indicator)) +
geom_col(position = "fill") +
coord_flip() +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
labs(
title = "Satisfaction with wait times by province (2024)",
x = NULL,
y = "Share of respondents",
fill = NULL
)
df_wait <- std_n %>%
filter(ref_date == 2024,
grepl("^Wait time,", indicator)) %>%
filter(geo != "Canada (excluding territories)") %>%
group_by(geo) %>%
mutate(share = value / sum(value)) %>%
ungroup()
ggplot(df_wait, aes(x = geo, y = share, fill = indicator)) +
geom_col(position = "fill") +
coord_flip() +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
labs(
title = "Distribution of specialist wait times by province (2024)",
x = NULL,
y = "Share of respondents",
fill = "Wait duration"
)
df_sat <- std_n %>%
filter(
ref_date == 2024,
indicator %in% c(
"Satisfaction with wait time - Very satisfied or satisfied",
"Satisfaction with wait time - Dissatisfied or very dissatisfied"
),
geo != "Canada (excluding territories)"
) %>%
filter(!is.na(value)) %>%              # üî¥ ÂøÖÈ°ª
group_by(geo) %>%
filter(n() == 2) %>%                   # üî¥ Âè™‰øùÁïô‰∏§Á±ªÈÉΩÈΩêÁöÑÁúÅ
mutate(share = value / sum(value)) %>%
ungroup()
ggplot(df_sat, aes(x = geo, y = share, fill = indicator)) +
geom_col(position = "fill") +
coord_flip() +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
labs(
title = "Satisfaction with wait times by province (2024)",
x = NULL,
y = "Share of respondents",
fill = NULL
)
df_wait <- std_n %>%
filter(
ref_date == 2024,
grepl("^Wait time,", indicator),
geo != "Canada (excluding territories)"
) %>%
filter(!is.na(value)) %>%
group_by(geo) %>%
filter(n() >= 2) %>%        # Ëá≥Â∞ë‰∏§Ê°£ÊâçÁîªÊØî‰æã
mutate(share = value / sum(value)) %>%
ungroup()
ggplot(df_wait, aes(x = geo, y = share, fill = indicator)) +
geom_col(position = "fill") +
coord_flip() +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
labs(
title = "Distribution of specialist wait times by province (2024)",
x = NULL,
y = "Share of respondents",
fill = "Wait duration"
)
### ‰øÆÊîπÂêéÁöÑÂõæ‰∏ÄÔºöÊåâÁúÅ‰ªΩÊòæÁ§∫ÂèóÂΩ±Âìç‰∫∫Êï∞ÁöÑÊûÑÊàêÁôæÂàÜÊØî
```{r}
df_aff <- std_n %>%
filter(ref_date == 2024,
indicator == "Life affected by wait time") %>%
filter(geo != "Canada (excluding territories)") %>%
arrange(value)
ggplot(df_aff, aes(x = reorder(geo, value), y = value)) +
geom_col() +
coord_flip() +
labs(
title = "People affected by healthcare wait times (2024)",
x = NULL,
y = "Number of persons"
) +
scale_y_continuous(labels = scales::label_number(big.mark = ","))
# 1) Áúã 2024 Âπ¥Âà∞Â∫ïÊúâÂì™‰∫õ statÔºàNumber of persons / Percentage Á≠âÔºâ
std %>%
filter(ref_date == 2024) %>%
count(stat, sort = TRUE)
# 2) Áúã indicator ÈáåÊúâÂì™‰∫õÂåÖÂê´ SatisfactionÔºà‰∏çË¶ÅÈù†ËÇâÁúºÁåúÔºâ
std %>%
filter(ref_date == 2024) %>%
filter(grepl("Satisfaction", indicator)) %>%
count(stat, indicator, sort = TRUE) %>%
head(50)
df_sat <- std %>%
filter(
grepl("Satisfaction", indicator),
stat == "Percentage",
ref_date == 2024,
geo != "Canada (excluding territories)"
) %>%
group_by(geo) %>%
mutate(share = value / sum(value)) %>%
ungroup()
ggplot(df_sat, aes(x = geo, y = share, fill = indicator)) +
geom_col(position = "fill") +
coord_flip() +
scale_y_continuous(labels = scales::percent_format()) +
labs(
title = "Satisfaction with wait times by province (2024)",
x = NULL,
y = "Share of respondents",
fill = NULL
)
df_wait <- std_n %>%
filter(
ref_date == 2024,
grepl("^Wait time,", indicator),
geo != "Canada (excluding territories)"
) %>%
filter(!is.na(value)) %>%
group_by(geo) %>%
filter(n() >= 2) %>%
mutate(share = value / sum(value)) %>%
ungroup()
ggplot(df_wait, aes(x = geo, y = share, fill = indicator)) +
geom_col(position = "fill") +
coord_flip() +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
labs(
title = "Distribution of specialist wait times by province (2024)",
x = NULL,
y = "Share of respondents",
fill = "Wait duration"
)
library(dplyr)
library(ggplot2)
library(scales)
df_aff <- std %>%
filter(
ref_date == 2024,
stat == "Number of persons",
indicator == "Life affected by wait time",
geo != "Canada (excluding territories)"
) %>%
filter(!is.na(value), is.finite(value), value >= 0) %>%
arrange(desc(value))
ggplot(df_aff, aes(x = reorder(geo, value), y = value)) +
geom_col() +
coord_flip() +
labs(
title = "People affected by healthcare wait times (2024)",
x = NULL,
y = "Number of persons"
) +
scale_y_continuous(labels = label_number(big.mark = ","))
library(dplyr)
library(ggplot2)
library(scales)
df_aff <- std %>%
filter(
ref_date == 2024,
stat == "Number of persons",
indicator == "Life affected by wait time",
geo != "Canada (excluding territories)"
) %>%
filter(!is.na(value), is.finite(value), value >= 0) %>%
arrange(desc(value))
ggplot(df_aff, aes(x = reorder(geo, value), y = value)) +
geom_col(fill = "steelblue") +
coord_flip() +
labs(
title = "People affected by healthcare wait times (2024)",
x = NULL,
y = "Number of persons"
) +
scale_y_continuous(labels = scales::label_number(big.mark = ","))
df_wait <- df_wait %>%
mutate(
indicator = factor(
indicator,
levels = c(
"Wait time, less than 3 months",
"Wait time, 3 months to less than 6 months",
"Wait time, 6 months or more"
)
)
)
ggplot(df_wait, aes(x = geo, y = share, fill = indicator)) +
geom_col(position = "fill") +
coord_flip() +
scale_y_continuous(
labels = scales::percent_format(accuracy = 1)
) +
scale_fill_manual(
values = c(
"Wait time, less than 3 months" = "#4E79A7",
"Wait time, 3 months to less than 6 months" = "#59A14F",
"Wait time, 6 months or more" = "#E15759"
)
) +
labs(
title = "Distribution of specialist wait times by province (2024)",
x = NULL,
y = "Share of respondents",
fill = "Wait duration"
)
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>",
message = FALSE,
warning = FALSE
)
# Make sure all chunks run from the package root directory
knitr::opts_knit$set(root.dir = normalizePath(".."))
# Install canHealthWaitR from GitHub if not already installed
if (!requireNamespace("canHealthWaitR", quietly = TRUE)) {
devtools::install_github("Ella0921/canHealthWaitR")
}
# Load packages
library(canHealthWaitR)
library(dplyr)
library(ggplot2)
ls("package:canHealthWaitR")
# Resolve a table from the registry using its table_key
tbl <- mw_resolve_table("wait_time")
tbl
pid <- tbl$product_id[[1]]
raw <- mw_read_data(pid)
std <- mw_standardize(raw, table_id = pid)
names(std)
dplyr::glimpse(std)
