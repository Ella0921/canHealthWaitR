---
title: "D plotting"
author: "Sasivimol Sirijangkapattana"
format: html
editor: visual
---

2 functions
-mw_plot_trend()
-mw_plot_compare()

```{r}
#' Plot wait time trend over time
#'
#' @param df standardized wait time data
#' @param province province filter
#' @param indicator indicator name
#' @export
mw_plot_trend <- function(df, province, indicator) {

  d <- df

  if (!is.null(province)) {
    d <- d[d$province == province, ]
  }

  d <- d[d$indicator == indicator, ]

  p <- ggplot2::ggplot(d, ggplot2::aes(x = year, y = value)) +
    ggplot2::geom_line() +
    ggplot2::geom_point() +
    ggplot2::theme_minimal()

  return(p)
}



#' Compare wait times across categories
#'
#' @param df standardized wait time data
#' @param year selected year
#' @param indicator indicator name
#' @export
mw_plot_compare <- function(df, year, indicator) {

  d <- df
  d <- d[d$year == year & d$indicator == indicator, ]

  p <- ggplot2::ggplot(d, ggplot2::aes(x = procedure, y = value)) +
    ggplot2::geom_col() +
    ggplot2::coord_flip() +
    ggplot2::theme_minimal()

  return(p)
}

```

